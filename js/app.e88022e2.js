(function(e){function t(t){for(var o,i,s=t[0],c=t[1],l=t[2],d=0,p=[];d<s.length;d++)i=s[d],a[i]&&p.push(a[i][0]),a[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);u&&u(t);while(p.length)p.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(o=!1)}o&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},a={app:0},r=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/vk-pm-downloader/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var o=n("64a9"),a=n.n(o);a.a},"287b":function(e,t,n){},"2bb6":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var o=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{attrs:{id:"app"}},[n("main",[n("div",{staticClass:"header"},[e._v("VK PM Downloader  v"+e._s(e.v)+" "),n("span",{staticClass:"free-label"},[e._v("Now free and open source")])]),n("Main")],1)])},r=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"text-xs-center wrapper"},[n("div",[n("v-dialog",{attrs:{width:"700"},model:{value:e.logpassDialog,callback:function(t){e.logpassDialog=t},expression:"logpassDialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline",attrs:{"primary-title":""}},[e._v("Вход по паролю")]),n("v-card-text",[n("v-form",[n("v-text-field",{attrs:{label:"Логин"},model:{value:e.login,callback:function(t){e.login=t},expression:"login"}}),n("v-text-field",{attrs:{type:"password",label:"Пароль"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),n("v-btn",{attrs:{color:"success"},on:{click:e.passwordLogin}},[e._v("Войти")])],1)],1)],1)],1),n("v-dialog",{attrs:{width:"700"},model:{value:e.tokenDialog,callback:function(t){e.tokenDialog=t},expression:"tokenDialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline",attrs:{"primary-title":""}},[e._v("Получите токен")]),n("v-card-text",[n("ul",[n("li",[e._v("через сайт "),n("a",{attrs:{target:"_blank",href:"https://vkhost.github.io/"}},[e._v("vkhost.github.io")]),e._v(' (выберите "Настройки", а там отметьте пункты "Сообщения" и "Доступ в любое время") ')]),n("li",[e._v(" напрямую по ссылке "),n("a",{attrs:{target:"_blank",href:"https://oauth.vk.com/authorize?client_id=6121396&scope=69632&redirect_uri=https://oauth.vk.com/blank.html&display=page&response_type=token&revoke=1"}},[e._v("\n          oauth.vk.com")])])]),n("br"),e._v("\n\n          Затем вставьте ссылку в данное меню:\n\n          "),n("v-form",[n("v-text-field",{attrs:{label:"Ссылка"},model:{value:e.tokenHref,callback:function(t){e.tokenHref=t},expression:"tokenHref"}}),n("v-text-field",{attrs:{label:"Токен",readonly:"",disabled:"",placeholder:"Введите ссылку"},model:{value:e.tokenHrefToken,callback:function(t){e.tokenHrefToken=t},expression:"tokenHrefToken"}}),n("v-btn",{attrs:{color:"success",disabled:0==e.tokenHrefToken.length},on:{click:function(t){e.token=e.tokenHrefToken,e.tokenDialog=!1,e.tokenUpdated(),e.init()}}},[e._v("Использовать данный токен")])],1)],1)],1)],1)],1),n("v-container",{staticStyle:{"padding-top":"0"},attrs:{fluid:"","grid-list-xl":""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{md12:"",xs12:""}},[n("v-card",[n("v-subheader",[e._v("Ваш аккаунт")]),n("v-card-text",[n("v-layout",{attrs:{row:""}},[n("v-flex",{attrs:{xs9:""}},[n("v-form",{staticClass:"text-xs-left"},[n("div",[n("v-text-field",{staticStyle:{"max-width":"300px","padding-bottom":"0px","margin-bottom":"0px"},attrs:{label:"Токен",required:""},on:{change:e.tokenUpdated},model:{value:e.token,callback:function(t){e.token=t},expression:"token"}}),n("a",{on:{click:function(t){e.tokenDialog=!0}}},[e._v("или получите токен вручную (рекомендуется)")]),n("br"),n("a",{on:{click:function(t){e.logpassDialog=!0}}},[e._v("или вход через логин и пароль")])],1),n("v-text-field",{attrs:{value:e.myself&&e.myself.first_name+" "+e.myself.last_name||"",label:"Имя",readonly:"",disabled:""}}),0===e.inittingStage?n("v-btn",{attrs:{color:"success"},on:{click:e.init}},[e._v("Войти")]):n("v-btn",{attrs:{color:"success",disabled:""}},[e._v("Войти")]),1===e.inittingStage?n("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}}):e._e()],1)],1),n("v-flex",{attrs:{xs3:""}},[n("v-img",{staticClass:"round",attrs:{"aspect-ratio":"1",contain:"",src:e.myself&&e.myself.photo_200||"https://placehold.jp/100x100.png"}})],1)],1),n("v-alert",{attrs:{value:e.error,type:"error"}},[e._v(e._s(e.error))])],1)],1)],1)],1),n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{md8:"",xs12:""}},[n("ChatList",{attrs:{chats:e.chats,userid:e.myself?e.myself.id:0}})],1),n("v-flex",{attrs:{md4:"",xs12:""}},[n("v-card",[n("v-subheader",[e._v("Скачать")]),n("div",[e._v(e._s(e.currentDialogLabel))]),e.downloading?n("v-progress-linear",{model:{value:e.currentDialogProgress,callback:function(t){e.currentDialogProgress=t},expression:"currentDialogProgress"}}):e._e(),n("v-progress-linear",{attrs:{hidden:""},model:{value:e.currentDialogPart,callback:function(t){e.currentDialogPart=t},expression:"currentDialogPart"}}),n("v-card-text",{staticStyle:{"padding-top":"0px"}},[n("v-select",{attrs:{"persistent-hint":"",hint:"JSON"===e.fileType?"для последующей обработки":"для непосредственного просмотра (генерируется из JSON, занимает больше времени)",items:["JSON","HTML"],label:"Тип файлов"},model:{value:e.fileType,callback:function(t){e.fileType=t},expression:"fileType"}}),n("br"),n("div",{staticStyle:{"text-align":"left"}},[n("a",{on:{click:function(t){e.attachmentsDownloadMenu=!0}}},[e._v("Скачать вложения?")])]),n("v-dialog",{attrs:{width:"700"},model:{value:e.attachmentsDownloadMenu,callback:function(t){e.attachmentsDownloadMenu=t},expression:"attachmentsDownloadMenu"}},[n("v-card",[n("v-card-text",[n("p",{staticClass:"title"},[e._v("Скачать вложения")]),n("p",[e._v("Данная версия сайта не поддерживает выкачку вложений, она качает прямые ссылки, чего зачастую достаточно для сохранения данных.")]),n("p",[n("b",[e._v("ОДНАКО")]),e._v(", если вам нужно именно сохранить вложения на диск, я разработал скрипт, который находит в скачанных HTML вложения и качает их.\n                  ")]),n("p",[e._v("\n                    Скрипт python3 (соотвественно нужен интерпретатор python3 на компьютере).\n                    "),n("br"),e._v("Скрипт качает\n                    "),n("b",[e._v("только фото и аудио сообщения")]),e._v(".\n                    "),n("br"),e._v("Скрипт консольный, т.е. управляется через интерфейс командной строки.\n                  ")]),n("p",[e._v("\n                    Скрипт доступен по "),n("a",{attrs:{href:"https://gist.github.com/zpix1/5bedb8911203047adf2be475e7dff625"}},[e._v("ссылке")]),e._v(".\n                  ")])]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",flat:""},on:{click:function(t){e.attachmentsDownloadMenu=!1}}},[e._v("Закрыть")])],1)],1)],1),e.countSelected>0&&!e.downloading?n("v-btn",{attrs:{color:"success"},on:{click:e.downloadSelected}},[e._v("Скачать "+e._s(e.countSelected))]):n("v-btn",{attrs:{color:"info",disabled:""}},[e._v("Скачать "+e._s(e.countSelected))])],1)],1),n("div",{staticStyle:{"margin-top":"24px"}},[n("About")],1)],1)],1)],1)],1)},s=[],c=(n("a481"),n("7f7f"),n("21a6")),l=n("bc3a"),u=n.n(l),d=n("c4e3"),p=n.n(d),f=n("974a"),h=(n("96cf"),n("3b8d")),m=(n("ac6a"),n("456d"),n("f2e8")),g=n.n(m),v=n("34a9"),b=n.n(v),_="5.81",y={token:null,version:_,loadVK:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.error,a="https://api.vk.com/method/".concat(e,"?access_token=").concat(this.token,"&v=").concat(_,"&https=1&").concat(Object.keys(t).reduce((function(e,n){return e.push(n+"="+encodeURIComponent(t[n])),e}),[]).join("&"));g()(a,null,(function(e,t){if(t.error)return console.error("load",a,t.error),void o(t.error);e?o(e):n(t.response)}))}};y.aloadVK=function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(t,n){var o,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o="https://api.vk.com/method/".concat(t,"?access_token=").concat(this.token,"&v=").concat(_,"&https=1&").concat(Object.keys(n).reduce((function(e,t){return e.push(t+"="+encodeURIComponent(n[t])),e}),[]).join("&")),e.next=3,b()(o,null,(function(e,t){return e?(console.error(e),e):t})).promise;case 3:if(a=e.sent,!a.error){e.next=7;break}return console.error("aload",o,a.error),e.abrupt("return",a.error);case 7:return e.abrupt("return",a.response);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}();var x,k=y;n("c5f6"),n("6762"),n("2fdb"),n("28a5");function w(e,t){var n=[2,0,1,1,1,2];return t[e%100>4&&e%100<20?2:n[e%10<5?e%10:5]]}function C(e){for(var t,n,o=[],a=0;a<e.length;a++){t=e[a],n=t;while(e[a+1]-e[a]==1)n=e[a+1],a++;t++,n++,o.push(t==n?t+"":t+"-"+n)}return o}function T(e,t){var n=Array.apply(null,{length:t}).map((function(){return 0}));if(!/^((\d+-\d+,? ?)|(\d+,? ?))+$/.test(e))return!1;for(var o=e.split(","),a=0;a<o.length;a++)if(o[a].includes("-")){var r=Number(o[a].split("-")[0].trim())-1,i=Number(o[a].split("-")[1].trim())-1,s=r>=0&&r<i&&i<t;if(!s)return!1;for(var c=r;c<i+1;c++){if(1==n[c])return!1;n[c]=1}}else{var l=Number(o[a].split("-")[0].trim())-1;if(l>=0&&l<t){if(1==n[l])return!1;n[l]=1}}return n}function E(e){for(var t=e.toLowerCase().split(" "),n=0;n<t.length;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].substring(1);return t.join(" ")}function S(){return!0}localStorage.getItem("pm_slow_mode")?(console.log("Slow mode: ON"),x={inUtils:700,mainLoop:2e3,retry:3e3,getUser:200}):x={inUtils:500,mainLoop:1e3,retry:2e3,getUser:100};var B={script:"250",code:"250"},I={dialog:function(e,t,n){var o,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=!1,i=n,s=function(){i("Инициализация",0,1);var t="";t=e<0?'var o=%o;return{u:API.groups.getById({group_ids:o,fields:"photo_100",v:5.81})[0],m:API.messages.getHistory({user_id:-o,v:5.81}).count};':'var o=%o;return{u:API.users.get({user_ids:o,fields:"photo_100,online,first_name_ins,last_name_ins",v:5.81})[0],m:API.messages.getHistory({user_id:o,v:5.81}).count};',k.loadVK("execute",{code:t.replace(/%o/i,Math.abs(e))},(function(e){e[name]&&(e.first_name="Группа",e.last_name=e.name),c(e)}))},c=function(e){o={user:e.u,count:e.m},l(0)},l=function t(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25;if(!1!==n&&!r){for(var a=[],i=0,s=o;i<s;++i)a.push("API.messages.getHistory({user_id:"+e+",v:5.81,offset:"+(n+200*i)+",count:200}).items");k.loadVK("execute",{code:"return["+a.join(",")+"];"},(function(e){(e=d(e)).isFull?setTimeout((function(){t(n+200*o)}),x.inUtils):p()}),(function(e){console.error(e,"retry in 2 seconds"),setTimeout((function(){t(n,1)}),x.inUtils)}))}},u=[],d=function(e){var t=[],n=!0;return e.forEach((function(e){Array.isArray(e)&&(t=t.concat(e))})),n=e[e.length-1]&&200==e[e.length-1].length,e=null,u=u.concat(t),{messages:t,isFull:n}},p=function(){var n=[];u.forEach((function(e){n.push(m.minifyMessage(e))}));var r=JSON.stringify({meta:{v:"1.2",p:e,a:k.uid,t:o.isChat?o.chat.title:o.user.first_name+" "+o.user.last_name,d:parseInt(new Date/1e3)},data:n});t({filename:"dialog"+e+"_"+E(Object(f["slugify"])(a).replace(/-/g," ")).replace(/ /g,"_")+".json",data:r})},h=1138741200,m={minifyMessage:function(e){var t={i:e.id,f:e.from_id,t:e.text,d:e.date-h};return e.attachments&&(t.a=m.minifyAttachments(e.attachments)),e.fwd_messages&&(t.m=m.minifyForwardedMessages(e.fwd_messages)),t},minifyAttachments:function(e){var t;return e.map((function(e){switch(t=e[e.type],e.type){case"photo":return{t:0,s:{m:t.sizes[Math.floor(1*t.sizes.length)-1].url,s:t.sizes[Math.floor(.7*t.sizes.length)].url,n:t.sizes[Math.floor(.5*t.sizes.length)].url,o:t.sizes[Math.floor(.4*t.sizes.length)].url,t:t.sizes[Math.floor(.2*t.sizes.length)].url},z:t.description||"",q:t.lat||0,w:t.long||0,o:t.user_id||t.owner_id,i:t.id,d:t.date-h};case"video":return{t:1,o:t.owner_id,i:t.id,n:t.title,z:t.description,d:t.date-h,s:{m:t.photo_2560,s:t.photo_1280,n:t.photo_807,o:t.photo_604,t:t.photo_130}};case"audio":return{t:2,o:t.owner_id,i:t.id,a:t.artist,n:t.title,d:t.duration,l:t.lyrics_id,g:t.genre_id,url:t.url};case"doc":return{t:3,o:t.owner_id,i:t.id,n:t.title,e:t.ext,s:t.size,url:t.url};case"sticker":return{t:4,i:t.id};case"gift":return{t:5,i:t.id};case"link":return{t:6,i:t.id,v:t.url};default:return{t:-1,s:e.type,v:e}}}))},minifyForwardedMessages:function(e){return e.map((function(e){var t={f:e.user_id,t:e.body,d:e.date-h};return e.attachments&&(t.a=m.minifyAttachments(e.attachments)),e.fwd_messages&&(t.m=m.minifyForwardedMessages(e.fwd_messages)),t}))}};s()},statDialogChate:null},D=I,M='!function(e,t){"use strict";"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.baguetteBox=t()}(this,function(){"use strict";var s,l,u,c,d,f=\'<svg width="44" height="60"><polyline points="30 10 10 30 30 50" stroke="rgba(255,255,255,0.5)" stroke-width="4"stroke-linecap="butt" fill="none" stroke-linejoin="round"/></svg>\',g=\'<svg width="44" height="60"><polyline points="14 10 34 30 14 50" stroke="rgba(255,255,255,0.5)" stroke-width="4"stroke-linecap="butt" fill="none" stroke-linejoin="round"/></svg>\',p=\'<svg width="30" height="30"><g stroke="rgb(160,160,160)" stroke-width="4"><line x1="5" y1="5" x2="25" y2="25"/><line x1="5" y1="25" x2="25" y2="5"/></g></svg>\',b={},m={captions:!0,buttons:"auto",fullScreen:!1,noScrollbars:!1,bodyClass:"baguetteBox-open",titleTag:!1,async:!1,preload:2,animation:"slideIn",afterShow:null,afterHide:null,onChange:null,overlayBackgroundColor:"rgba(0,0,0,.8)"},v={},h=[],o=0,n=!1,i={},a=!1,y=/.+.(gif|jpe?g|png|webp)/i,w={},k=[],r=null,x=function(e){-1!==e.target.id.indexOf("baguette-img")&&j()},C=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,D()},E=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,X()},B=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,j()},T=function(e){i.count++,1<i.count&&(i.multitouch=!0),i.startX=e.changedTouches[0].pageX,i.startY=e.changedTouches[0].pageY},N=function(e){if(!a&&!i.multitouch){e.preventDefault?e.preventDefault():e.returnValue=!1;var t=e.touches[0]||e.changedTouches[0];40<t.pageX-i.startX?(a=!0,D()):t.pageX-i.startX<-40?(a=!0,X()):100<i.startY-t.pageY&&j()}},L=function(){i.count--,i.count<=0&&(i.multitouch=!1),a=!1},A=function(){L()},P=function(e){"block"===s.style.display&&s.contains&&!s.contains(e.target)&&(e.stopPropagation(),Y())};function S(e){if(w.hasOwnProperty(e)){var t=w[e].galleries;[].forEach.call(t,function(e){[].forEach.call(e,function(e){W(e.imageElement,"click",e.eventHandler)}),h===e&&(h=[])}),delete w[e]}}function F(e){switch(e.keyCode){case 37:D();break;case 39:X();break;case 27:j();break;case 36:!function t(e){e&&e.preventDefault();return M(0)}(e);break;case 35:!function n(e){e&&e.preventDefault();return M(h.length-1)}(e)}}function H(e,t){if(h!==e){for(h=e,function r(e){e||(e={});for(var t in m)b[t]=m[t],"undefined"!=typeof e[t]&&(b[t]=e[t]);l.style.transition=l.style.webkitTransition="fadeIn"===b.animation?"opacity .4s ease":"slideIn"===b.animation?"":"none","auto"===b.buttons&&("ontouchstart"in window||1===h.length)&&(b.buttons=!1);u.style.display=c.style.display=b.buttons?"":"none";try{s.style.backgroundColor=b.overlayBackgroundColor}catch(n){}}(t);l.firstChild;)l.removeChild(l.firstChild);for(var n,o=[],i=[],a=k.length=0;a<e.length;a++)(n=J("div")).className="full-image",n.id="baguette-img-"+a,k.push(n),o.push("baguetteBox-figure-"+a),i.push("baguetteBox-figcaption-"+a),l.appendChild(k[a]);s.setAttribute("aria-labelledby",o.join(" ")),s.setAttribute("aria-describedby",i.join(" "))}}function I(e){b.noScrollbars&&(document.documentElement.style.overflowY="hidden",document.body.style.overflowY="scroll"),"block"!==s.style.display&&(U(document,"keydown",F),i={count:0,startX:null,startY:null},q(o=e,function(){z(o),V(o)}),R(),s.style.display="block",b.fullScreen&&function t(){s.requestFullscreen?s.requestFullscreen():s.webkitRequestFullscreen?s.webkitRequestFullscreen():s.mozRequestFullScreen&&s.mozRequestFullScreen()}(),setTimeout(function(){s.className="visible",b.bodyClass&&document.body.classList&&document.body.classList.add(b.bodyClass),b.afterShow&&b.afterShow()},50),b.onChange&&b.onChange(o,k.length),r=document.activeElement,Y(),n=!0)}function Y(){b.buttons?u.focus():d.focus()}function j(){b.noScrollbars&&(document.documentElement.style.overflowY="auto",document.body.style.overflowY="auto"),"none"!==s.style.display&&(W(document,"keydown",F),s.className="",setTimeout(function(){s.style.display="none",document.fullscreen&&function e(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}(),b.bodyClass&&document.body.classList&&document.body.classList.remove(b.bodyClass),b.afterHide&&b.afterHide(),r&&r.focus(),n=!1},500))}function q(t,n){var e=k[t],o=h[t];if(void 0!==e&&void 0!==o)if(e.getElementsByTagName("img")[0])n&&n();else{var i=o.imageElement,a=i.getElementsByTagName("img")[0],r="function"==typeof b.captions?b.captions.call(h,i):i.getAttribute("data-caption")||i.title,s=function d(e){var t=e.href;if(e.dataset){var n=[];for(var o in e.dataset)"at-"!==o.substring(0,3)||isNaN(o.substring(3))||(n[o.replace("at-","")]=e.dataset[o]);for(var i=Object.keys(n).sort(function(e,t){return parseInt(e,10)<parseInt(t,10)?-1:1}),a=window.innerWidth*window.devicePixelRatio,r=0;r<i.length-1&&i[r]<a;)r++;t=n[i[r]]||t}return t}(i),l=J("figure");if(l.id="baguetteBox-figure-"+t,l.innerHTML=\'<div class="baguetteBox-spinner"><div class="baguetteBox-double-bounce1"></div><div class="baguetteBox-double-bounce2"></div></div>\',b.captions&&r){var u=J("figcaption");u.id="baguetteBox-figcaption-"+t,u.innerHTML=r,l.appendChild(u)}e.appendChild(l);var c=J("img");c.onload=function(){var e=document.querySelector("#baguette-img-"+t+" .baguetteBox-spinner");l.removeChild(e),!b.async&&n&&n()},c.setAttribute("src",s),c.alt=a&&a.alt||"",b.titleTag&&r&&(c.title=r),l.appendChild(c),b.async&&n&&n()}}function X(){return M(o+1)}function D(){return M(o-1)}function M(e,t){return!n&&0<=e&&e<t.length?(H(t,b),I(e),!0):e<0?(b.animation&&O("left"),!1):e>=k.length?(b.animation&&O("right"),!1):(q(o=e,function(){z(o),V(o)}),R(),b.onChange&&b.onChange(o,k.length),!0)}function O(e){l.className="bounce-from-"+e,setTimeout(function(){l.className=""},400)}function R(){var e=100*-o+"%";"fadeIn"===b.animation?(l.style.opacity=0,setTimeout(function(){v.transforms?l.style.transform=l.style.webkitTransform="translate3d("+e+",0,0)":l.style.left=e,l.style.opacity=1},400)):v.transforms?l.style.transform=l.style.webkitTransform="translate3d("+e+",0,0)":l.style.left=e}function z(e){e-o>=b.preload||q(e+1,function(){z(e+1)})}function V(e){o-e>=b.preload||q(e-1,function(){V(e-1)})}function U(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o):e.attachEvent("on"+t,function(e){(e=e||window.event).target=e.target||e.srcElement,n(e)})}function W(e,t,n,o){e.removeEventListener?e.removeEventListener(t,n,o):e.detachEvent("on"+t,n)}function G(e){return document.getElementById(e)}function J(e){return document.createElement(e)}return[].forEach||(Array.prototype.forEach=function(e,t){for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)}),[].filter||(Array.prototype.filter=function(e,t,n,o,i){for(n=this,o=[],i=0;i<n.length;i++)e.call(t,n[i],i,n)&&o.push(n[i]);return o}),{run:function K(e,t){return v.transforms=function n(){var e=J("div");return"undefined"!=typeof e.style.perspective||"undefined"!=typeof e.style.webkitPerspective}(),v.svg=function o(){var e=J("div");return e.innerHTML="<svg/>","http://www.w3.org/2000/svg"===(e.firstChild&&e.firstChild.namespaceURI)}(),v.passiveEvents=function i(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t)}catch(n){}return e}(),function a(){if(s=G("baguetteBox-overlay"))return l=G("baguetteBox-slider"),u=G("previous-button"),c=G("next-button"),void(d=G("close-button"));(s=J("div")).setAttribute("role","dialog"),s.id="baguetteBox-overlay",document.getElementsByTagName("body")[0].appendChild(s),(l=J("div")).id="baguetteBox-slider",s.appendChild(l),(u=J("button")).setAttribute("type","button"),u.id="previous-button",u.setAttribute("aria-label","Previous"),u.innerHTML=v.svg?f:"&lt;",s.appendChild(u),(c=J("button")).setAttribute("type","button"),c.id="next-button",c.setAttribute("aria-label","Next"),c.innerHTML=v.svg?g:"&gt;",s.appendChild(c),(d=J("button")).setAttribute("type","button"),d.id="close-button",d.setAttribute("aria-label","Close"),d.innerHTML=v.svg?p:"&times;",s.appendChild(d),u.className=c.className=d.className="baguetteBox-button",function t(){var e=v.passiveEvents?{passive:!0}:null;U(s,"click",x),U(u,"click",C),U(c,"click",E),U(d,"click",B),U(l,"contextmenu",A),U(s,"touchstart",T,e),U(s,"touchmove",N,e),U(s,"touchend",L),U(document,"focus",P,!0)}()}(),S(e),function r(e,a){var t=document.querySelectorAll(e),n={galleries:[],nodeList:t};return w[e]=n,[].forEach.call(t,function(e){a&&a.filter&&(y=a.filter);var t=[];if(t="A"===e.tagName?[e]:e.getElementsByTagName("a"),0!==(t=[].filter.call(t,function(e){if(-1===e.className.indexOf(a&&a.ignoreClass))return y.test(e.href)})).length){var i=[];[].forEach.call(t,function(e,t){var n=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,H(i,a),I(t)},o={eventHandler:n,imageElement:e};U(e,"click",n),i.push(o)}),n.galleries.push(i)}}),n.galleries}(e,t)},show:M,showNext:X,showPrevious:D,hide:j,destroy:function e(){!function t(){var e=v.passiveEvents?{passive:!0}:null;W(s,"click",x),W(u,"click",C),W(c,"click",E),W(d,"click",B),W(l,"contextmenu",A),W(s,"touchstart",T,e),W(s,"touchmove",N,e),W(s,"touchend",L),W(document,"focus",P,!0)}(),function n(){for(var e in w)w.hasOwnProperty(e)&&S(e)}(),W(document,"keydown",F),document.getElementsByTagName("body")[0].removeChild(document.getElementById("baguetteBox-overlay")),w={},h=[],o=0}}});',L='#baguetteBox-overlay{display:none;opacity:0;position:fixed;overflow:hidden;top:0;left:0;width:100%;height:100%;z-index:1000000;background-color:#222;background-color:rgba(0,0,0,.8);-webkit-transition:opacity .5s ease;transition:opacity .5s ease}#baguetteBox-overlay.visible{opacity:1}#baguetteBox-overlay .full-image{display:inline-block;position:relative;width:100%;height:100%;text-align:center}#baguetteBox-overlay .full-image figure{display:inline;margin:0;height:100%}#baguetteBox-overlay .full-image img{display:inline-block;width:auto;height:auto;max-height:100%;max-width:100%;vertical-align:middle;-webkit-box-shadow:0 0 8px rgba(0,0,0,.6);-moz-box-shadow:0 0 8px rgba(0,0,0,.6);box-shadow:0 0 8px rgba(0,0,0,.6)}#baguetteBox-overlay .full-image figcaption{display:block;position:absolute;bottom:0;width:100%;text-align:center;line-height:1.8;white-space:normal;color:#ccc;background-color:#000;background-color:rgba(0,0,0,.6);font-family:sans-serif}#baguetteBox-overlay .full-image:before{content:"";display:inline-block;height:50%;width:1px;margin-right:-1px}#baguetteBox-slider{position:absolute;left:0;top:0;height:100%;width:100%;white-space:nowrap;-webkit-transition:left .4s ease,-webkit-transform .4s ease;transition:left .4s ease,-webkit-transform .4s ease;transition:left .4s ease,transform .4s ease;transition:left .4s ease,transform .4s ease,-webkit-transform .4s ease,-moz-transform .4s ease}#baguetteBox-slider.bounce-from-right{-webkit-animation:bounceFromRight .4s ease-out;animation:bounceFromRight .4s ease-out}#baguetteBox-slider.bounce-from-left{-webkit-animation:bounceFromLeft .4s ease-out;animation:bounceFromLeft .4s ease-out}@-webkit-keyframes bounceFromRight{0%,100%{margin-left:0}50%{margin-left:-30px}}@keyframes bounceFromRight{0%,100%{margin-left:0}50%{margin-left:-30px}}@-webkit-keyframes bounceFromLeft{0%,100%{margin-left:0}50%{margin-left:30px}}@keyframes bounceFromLeft{0%,100%{margin-left:0}50%{margin-left:30px}}.baguetteBox-button#next-button,.baguetteBox-button#previous-button{top:50%;top:calc(50% - 30px);width:44px;height:60px}.baguetteBox-button{position:absolute;cursor:pointer;outline:0;padding:0;margin:0;border:0;-moz-border-radius:15%;border-radius:15%;background-color:#323232;background-color:rgba(50,50,50,.5);color:#ddd;font:1.6em sans-serif;-webkit-transition:background-color .4s ease;transition:background-color .4s ease}.baguetteBox-button:focus,.baguetteBox-button:hover{background-color:rgba(50,50,50,.9)}.baguetteBox-button#next-button{right:2%}.baguetteBox-button#previous-button{left:2%}.baguetteBox-button#close-button{top:20px;right:2%;right:calc(2% + 6px);width:30px;height:30px}.baguetteBox-button svg{position:absolute;left:0;top:0}.baguetteBox-spinner{width:40px;height:40px;display:inline-block;position:absolute;top:50%;left:50%;margin-top:-20px;margin-left:-20px}.baguetteBox-double-bounce1,.baguetteBox-double-bounce2{width:100%;height:100%;-moz-border-radius:50%;border-radius:50%;background-color:#fff;opacity:.6;position:absolute;top:0;left:0;-webkit-animation:bounce 2s infinite ease-in-out;animation:bounce 2s infinite ease-in-out}.baguetteBox-double-bounce2{-webkit-animation-delay:-1s;animation-delay:-1s}@-webkit-keyframes bounce{0%,100%{-webkit-transform:scale(0);transform:scale(0)}50%{-webkit-transform:scale(1);transform:scale(1)}}@keyframes bounce{0%,100%{-webkit-transform:scale(0);-moz-transform:scale(0);transform:scale(0)}50%{-webkit-transform:scale(1);-moz-transform:scale(1);transform:scale(1)}}',P={};P.API=k;var N=1138741200,j=function(e){return e+N};function A(e){var t=new Date(1e3*e),n=t.getFullYear(),o=t.getMonth()+1,a=t.getDate(),r=t.getHours(),i=t.getMinutes(),s=t.getSeconds(),c="  "+a+"/"+o+"/"+n+" "+r+":"+i+":"+s;return c}var U=function(e){return!!e&&e.map((function(t){switch(t.t){case 0:return{type:"photo",photo:{photo_2560:t.s.m,photo_1280:t.s.s,photo_807:t.s.n,photo_604:t.s.o,photo_130:t.s.t,description:t.z,lat:t.q,long:t.w,owner_id:t.o,id:t.i,date:j(t.d)}};case 1:return{type:"video",video:{owner_id:t.o,id:t.i,title:t.n,description:t.z,date:j(t.d),duration:t.s,photo_2560:t.s.m,photo_1280:t.s.s,photo_807:t.s.n,photo_604:t.s.o,photo_130:t.s.t}};case 2:return{type:"audio",audio:{owner_id:t.o,id:t.i,artist:t.a,title:e.n,duration:t.d,lyrics_id:t.l,genre_id:t.g,url:t.url}};case 3:return{type:"doc",doc:{owner_id:t.o,id:t.i,title:t.n,ext:t.e,size:t.s,url:t.url}};case 4:return{type:"sticker",sticker:{id:t.i}};case 5:return{type:"gift",gift:{id:t.i}};case 6:return{type:"link",link:{id:t.i,value:t.v}};default:return{type:-1,value:t}}}))},z=function e(t){if(!t)return!1;var n=[];return t.forEach((function(t){n.push({user_id:t.f,date:t.d+N,body:t.t,attachments:U(t.a),fwd_messages:e(t.m)})})),n};function O(e,t,n){return{out:(t.a?t.a:n)===e.f,user_id:e.f,from_id:e.f,date:e.d+N,body:e.t,read_state:!0,id:e.i,attachments:U(e.a),fwd_messages:z(e.m)}}var H={};function R(e){return new Promise((function(t){return setTimeout(t,e)}))}function F(e){return J.apply(this,arguments)}function J(){return J=Object(h["a"])(regeneratorRuntime.mark((function e(t){var n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t in H)){e.next=4;break}return e.abrupt("return",H[t]);case 4:if(!(t<0)){e.next=22;break}return e.next=7,k.aloadVK("groups.getById",{group_ids:Math.abs(t),fields:"photo_100"});case 7:if(n=e.sent,!n.error_code){e.next=13;break}return console.error(n.error_msg,"retry in 2 seconds"),e.next=12,R(x.retry);case 12:return e.abrupt("return",F(t));case 13:return n=n[0],n.first_name="Группа",n.last_name=n.name,H[t]=n,e.next=19,R(x.getUser);case 19:return e.abrupt("return",n);case 22:return e.next=24,k.aloadVK("users.get",{user_ids:t,fields:"photo_100"});case 24:if(o=e.sent,!o.error_code){e.next=30;break}return console.error(o.error_msg,"retry in 2 seconds"),e.next=29,R(x.retry);case 29:return e.abrupt("return",F(t));case 30:return o=o[0],H[t]=o,e.next=34,R(x.getUser);case 34:return e.abrupt("return",o);case 35:case"end":return e.stop()}}),e)}))),J.apply(this,arguments)}function q(e,t,n){return V.apply(this,arguments)}function V(){return V=Object(h["a"])(regeneratorRuntime.mark((function e(t,n,o){var a,r,i,s,c,l,u,d,p,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(a=JSON.parse(t.data),r=[],i=0;i<a.data.length;i++)r.push(O(a.data[i],a.meta,n));return r=r.reverse(),e.next=6,F(+a.meta.p);case 6:return a.meta=e.sent,e.next=9,F(n);case 9:s=e.sent,c=document.createElement("div"),c.className="messages round_upic main_wrapper",l=document.createElement("h1"),l.innerText="PM Downloader v".concat("1.7.1"),c.appendChild(l),u=0;case 16:if(!(u<r.length)){e.next=38;break}if(!r[u].out){e.next=25;break}return e.t0=c,e.next=21,W(r[u],s);case 21:e.t1=e.sent,e.t0.appendChild.call(e.t0,e.t1),e.next=35;break;case 25:return e.t2=c,e.t3=W,e.t4=r[u],e.next=30,F(r[u].from_id);case 30:return e.t5=e.sent,e.next=33,(0,e.t3)(e.t4,e.t5);case 33:e.t6=e.sent,e.t2.appendChild.call(e.t2,e.t6);case 35:u++,e.next=16;break;case 38:d=document.createElement("html"),d.innerHTML='\n        <head>\n            <meta charset="UTF-8">\n            <meta name="viewport" content="width=device-width, initial-scale=1.0">\n            <meta http-equiv="X-UA-Compatible" content="ie=edge">\n            <title>PM Downloader v'.concat("1.7.1"," ").concat(t.filename.replace(".json",".html"),'</title>\n            <style>\n            h4{font-family:inherit;font-weight:500;line-height:1.1;color:inherit;margin-top:10px;margin-bottom:10px;font-size:18px}\n            body{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:14px;line-height:1.42857143;color:#333;background-color:#fff;margin:0}\n            hr{height:0;margin-top:20px;margin-bottom:20px;border:0;border-top:1px solid #eee}.messages{margin:30px;text-align:left}.msg_item{overflow:hidden}\n            .from,.msg_body,.att_head,.attachments,.attachment,.fwd{margin-left:60px;min-height:1px;padding-right:15px;padding-left:15px}.msg_item{margin-top:5px}\n            .upic{float:left}.upic img{vertical-align:top;padding:5px;width:50px;height:50px}.round_upic .upic img{border-radius:50%}a{color:#337ab7;text-decoration:none}\n            a:active,a:hover{outline:0}a:focus,a:hover{color:#23527c;text-decoration:underline}\n            .att_head{color:#777}.att_ico{float:left;width:11px;height:11px;margin:3px 3px 2px;background-image:url(http://vk.com/images/icons/mono_iconset.gif)}\n            .att_photo{background-position:0 -30px;max-width:300px;max-height:300px; margin-bottom: 5px;}.att_audio{background-position:0 -222px}.att_video{background-position:0 -75px}\n            .att_doc{background-position:0 -280px}.att_wall,.att_fwd{background-position:0 -194px}.att_gift{background-position:0 -105px}\n            .att_sticker{background-position:0 -362px;width:12px;height:12px}.att_link{background-position:0 -237px}.attb_link a span{color:#777!important}\n            .att_geo{background-position:0 -165px}.fwd{border:2px solid #C3D1E0;border-width:0 0 0 2px;margin-left:85px}.attachments{margin:5px;float:left}\n            .attachment_title{font-size:20px;}.hidden_ta_at{display:none}.main_wrapper{margin:auto;max-width:1000px}\n            </style>\n            <style>').concat(L,"</style>\n            </head>\n            <script>").concat(M,"<\/script>\n        <body>\n        </body>\n        "),d.getElementsByTagName("body")[0].appendChild(c),p=document.createElement("script"),p.innerText="baguetteBox.run('.gallery');",d.getElementsByTagName("body")[0].appendChild(p),f=document.createElement("div"),f.appendChild(d),o({data:f.innerHTML.replaceAll("data-lasy_src","src"),filename:t.filename.replace(".json",".html")});case 47:case"end":return e.stop()}}),e)}))),V.apply(this,arguments)}function W(e,t){return X.apply(this,arguments)}function X(){return X=Object(h["a"])(regeneratorRuntime.mark((function e(t,n){var o,a,r,i,s,c,l,u,d,p,f,h,m,g,v,b;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o="".concat(n.first_name," ").concat(n.last_name),a=document.createElement("div"),a.className="msg_item message",a.id=t.id,r=document.createElement("div"),r.className="upic",i=document.createElement("img"),i.dataset.lasy_src=n.photo_100,r.appendChild(i),a.appendChild(r),s=document.createElement("div"),s.className="from",c=document.createElement("b"),c.innerText=o+" ",l=document.createElement("a"),l.href="https://vk.com/id".concat(n.id),l.target="_blank",l.innerText="@id".concat(n.id),u=document.createElement("a"),u.href="#msg".concat(t.id),u.innerText=A(t.date),s.appendChild(c),s.appendChild(l),s.appendChild(u),a.appendChild(s),d=document.createElement("div"),d.className="msg_body",d.innerText=t.body,a.appendChild(d),t.attachments){for(p=document.createElement("div"),p.className="attachments",p.id="attach"+t.id,f=0;f<t.attachments.length;f++)h=t.attachments[f],p.appendChild(K(h));a.appendChild(p)}if(!t.fwd_messages){e.next=49;break}m=document.createElement("div"),m.className="fwd",g=0;case 34:if(!(g<t.fwd_messages.length)){e.next=48;break}return v=t.fwd_messages[g],e.next=38,F(v.user_id);case 38:return b=e.sent,b||(b={id:v.user_id,first_name:"Ошибка",last_name:"Профиля id".concat(v.user_id),photo_100:"https://vk.com/images/deactivated_100.png?ava=1"}),e.t0=m,e.next=43,W(v,b);case 43:e.t1=e.sent,e.t0.appendChild.call(e.t0,e.t1);case 45:g++,e.next=34;break;case 48:a.appendChild(m);case 49:return e.abrupt("return",a);case 50:case"end":return e.stop()}}),e)}))),X.apply(this,arguments)}function Y(e){var t="photo_130 photo_604 photo_807 photo_1280 photo_2560".split(" "),n=[0,0];return t.forEach((function(t){e[t]&&(n[0]=e[t])})),e.photo_604?n[1]=e.photo_604:t.reverse().forEach((function(t){e[t]&&(n[1]=e[t])})),n}function K(e){var t=document.createElement("div"),n=document.createElement("textarea");if(n.className="hidden_ta_at",n.innerText=JSON.stringify(e),t.appendChild(n),"photo"===e.type){var o=document.createElement("div");o.className="gallery";var a=document.createElement("a");a.href=Y(e[e.type])[0],a.className="download_photo_type",a.dataset.src=Y(e[e.type])[0];var r=document.createElement("img");r.dataset.lasy_src=Y(e[e.type])[1],r.className="att_photo",a.appendChild(r),o.appendChild(a),t.appendChild(o)}else if("video"==e.type){var i=document.createElement("div");i.className="gallery";var s=document.createElement("b");s.innerText="<полное видео не показано>",n.className="";var c=document.createElement("a");c.href=Y(e[e.type])[0];var l=document.createElement("img");l.dataset.lasy_src=Y(e[e.type])[1],c.appendChild(l),i.appendChild(c),t.appendChild(s),t.appendChild(i)}else if("audio"==e.type){var u=document.createElement("div"),d=document.createElement("b");d.innerText=e[e.type].artist;var p=document.createElement("br"),f=document.createElement("audio");f.dataset.lasy_src=e[e.type].url,f.dataset.src=e[e.type].url,e[e.type].url&&(f.className="download_audio_message_type"),f.controls="controls",u.appendChild(d),u.appendChild(p),u.appendChild(f),t.appendChild(u)}else if("doc"==e.type){var h=document.createElement("div"),m=document.createElement("a");m.innerText=e[e.type].title,m.href=e[e.type].url,h.appendChild(m),t.appendChild(h)}else n.className="";return t}P.json2html=q;var $=P,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-layout",{attrs:{row:""}},[n("v-flex",[n("v-card",[n("v-list",{attrs:{subheader:""}},[n("v-subheader",[e._v("Выбрать чаты")]),n("v-list-tile",[n("v-list-tile-content",[n("v-list-tile-title",[e._v("Выбрать диапазон")])],1),n("v-list-tile-action",[n("v-text-field",{staticStyle:{"max-width":"190px"},attrs:{rules:e.chatRangeTextRules},model:{value:e.chatRangeText,callback:function(t){e.chatRangeText=t},expression:"chatRangeText"}})],1)],1),n("v-list-tile",[n("v-list-tile-content",[n("v-list-tile-title",[e._v("Выбрать все")])],1),n("v-list-tile-action",{on:{click:e.chatsUpdated}},[n("v-checkbox",{attrs:{color:"green"},model:{value:e.allSelected,callback:function(t){e.allSelected=t},expression:"allSelected"}})],1)],1),e._l(e.chats.slice(0,e.showChatsCount),(function(t){return n("v-list-tile",{key:t.peer_id,attrs:{avatar:""}},[n("v-list-tile-avatar",[n("img",{attrs:{src:t.peerInfo.photo_100}})]),n("v-list-tile-content",[n("v-list-tile-title",[e._v(e._s(t.peerInfo.first_name)+" "+e._s(t.peerInfo.last_name))])],1),"group"===t.type?n("v-chip",{on:{click:function(t){return e.selectType("group")}}},[e._v("Группа")]):e._e(),"chat"===t.type?n("v-chip",{on:{click:function(t){return e.selectType("chat")}}},[e._v("Беседа")]):e._e(),"user"===t.type?n("v-chip",{on:{click:function(t){return e.selectType("user")}}},[e._v("Пользователь")]):e._e(),n("v-list-tile-action",{on:{click:e.chatsUpdated}},[n("v-checkbox",{model:{value:t.selected,callback:function(n){e.$set(t,"selected",n)},expression:"c.selected"}})],1)],1)})),e.chats.length>e.showChatsCount?n("v-list-tile",[n("v-list-tile-content",[n("v-list-tile-title",[e._v("И еще "+e._s(e.chats.length-e.showChatsCount)+" "+e._s(e.declOfNum(e.chats.length-e.showChatsCount,["чат","чата","чатов"])))])],1),e.selectLast?e._e():n("v-btn",{attrs:{color:"primary"},on:{click:function(t){e.unlockDialog=!0}}},[e._v("разблокировать")]),e.selectLast?n("v-btn",{attrs:{color:"info"},on:{click:function(t){e.showAll=!e.showAll}}},[e._v(" "+e._s(e.showAll?"свернуть":"развернуть")+" ")]):e._e()],1):e._e(),e.chats.length>e.showChatsCount&&e.showAll?n("div",{attrs:{transition:"scale-transition"}},e._l(e.chats.slice(e.showChatsCount,e.chats.length),(function(t){return n("v-list-tile",{key:t.peer_id,attrs:{avatar:""}},[n("v-list-tile-avatar",[n("img",{attrs:{src:t.peerInfo.photo_100}})]),n("v-list-tile-content",[n("v-list-tile-title",[e._v(e._s(t.peerInfo.first_name)+" "+e._s(t.peerInfo.last_name))])],1),"group"===t.type?n("v-chip",{on:{click:function(t){return e.selectType("group")}}},[e._v("Группа")]):e._e(),"chat"===t.type?n("v-chip",{on:{click:function(t){return e.selectType("chat")}}},[e._v("Беседа")]):e._e(),"user"===t.type?n("v-chip",{on:{click:function(t){return e.selectType("user")}}},[e._v("Пользователь")]):e._e(),n("v-list-tile-action",{on:{click:e.chatsUpdated}},[n("v-checkbox",{model:{value:t.selected,callback:function(n){e.$set(t,"selected",n)},expression:"c.selected"}})],1)],1)})),1):e._e()],2)],1)],1)],1)},Q=[],Z={name:"ChatList",props:["chats","userid"],data:function(){var e=this;return{error:null,code:"",showChatsCount:10,showAll:!1,selectLast:!1,chatRangeText:null,chatRangeTextRules:[function(e){return!!e||"введите диапазон"},function(t){return!!T(t,e.selectLast?e.chats.length:e.showChatsCount)||"диапазон не валиден"}]}},methods:{declOfNum:w,chatsUpdated:function(){for(var e=[],t=0;t<this.chats.length;t++)this.chats[t].selected&&e.push(t);this.chatRangeText=C(e).join(", ")},selectType:function(e){for(var t=[],n=0;n<(this.selectLast?this.chats.length:this.showChatsCount);n++)this.chats[n].type===e&&(t.push(n),this.chats[n].selected=!0);this.chatRangeText=C(t).join(", ")}},created:function(){this.code=localStorage.getItem("pm_activation_code",this.code),S(this.code)&&(this.selectLast=!0,localStorage.setItem("pm_activation_code",this.code))},watch:{chats:function(){if(!this.selectLast){for(var e=this.showChatsCount;e<this.chats.length;e++)this.chats[e].selected=!1;this.$forceUpdate()}this.chatsUpdated()},chatRangeText:function(e){var t=T(e,this.selectLast?this.chats.length:this.showChatsCount);if(t){for(var n=0;n<this.chats.length;n++)this.chats[n].selected=t[n];this.$forceUpdate()}}},computed:{allSelected:{get:function(){return this.selectLast?this.chats.every((function(e){return e.selected})):this.chats.slice(0,this.showChatsCount).every((function(e){return e.selected}))},set:function(){for(var e=!this.allSelected,t=0;t<(this.selectLast?this.chats.length:this.showChatsCount);t++)this.chats[t].selected=e;this.$forceUpdate()}},notShowSelected:{get:function(){return this.chats.slice(this.showChatsCount).every((function(e){return e.selected}))},set:function(){for(var e=!this.notShowSelected,t=this.showChatsCount;t<this.chats.length;t++)this.chats[t].selected=e;this.$forceUpdate()}}}},ee=Z,te=(n("fc86"),n("2877")),ne=Object(te["a"])(ee,G,Q,!1,null,null,null),oe=ne.exports,ae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{width:"700"},model:{value:e.moreInformationModel,callback:function(t){e.moreInformationModel=t},expression:"moreInformationModel"}},[n("v-card",[n("v-card-text",[n("p",{staticClass:"title"},[e._v("История версий")]),n("p",[n("b",[e._v("v1.0")]),e._v(" Релиз "),n("br"),n("b",[e._v("v1.1")]),e._v(" Повышен лимит чатов для закачки с 40 до 1000 (имейте в виду, что реально он меньше, так как удаляются все беседы и сообщения групп) "),n("br"),n("b",[e._v("v1.2")]),e._v(" Добавлена поддержка большего числа видов вложений (видео/аудио); улучшения загрузчика "),n("br"),n("b",[e._v("v1.3")]),e._v(" Добавлен скрипт загрузки вложений; добавлен выбор промежутков "),n("br"),n("b",[e._v("v1.4")]),e._v(" Добавлена возможность выбора диалогов по отдельности "),n("br"),n("b",[e._v("v1.5")]),e._v(" Добавлена поддержка выкачки бесед и сообщений с группами "),n("br"),n("b",[e._v("v1.5.1")]),e._v(" Изменен алгоритм проверки кодов; пользователи, уже купившие коды не должны пострадать, если все же не работает - пишите мне "),n("br"),n("b",[e._v("v1.5.2")]),e._v(' Исправлена ошибка "Too many requests per second" '),n("br"),n("b",[e._v("v1.5.4")]),e._v(" Исправлены ошибки связанные с обновлением версий VK API "),n("br"),n("b",[e._v("v1.5.5")]),e._v(" Добавлена возможность выбора только пользователей (исключая группы и беседы) "),n("br"),n("b",[e._v("v1.6.0")]),e._v(" Оптимизации, скорость закачки значительно выросла "),n("br"),n("b",[e._v("v1.7.0")]),e._v(" Сайт становится полностью бесплатным, исходный код открыт \n      "),n("a",{attrs:{href:"https://github.com/zpix1/vk-pm-downloader"}},[e._v("Github")]),n("br")]),n("p",{staticClass:"title"},[e._v("Общая информация")]),n("p",[e._v("JSON - идентично apidog'овскому формату, можно засунуть в их анализатор"),n("br"),e._v("\n           HTML - отображение диалога как в ВК (только некоторые типы вложений не отбражаются)"),n("br"),e._v("\n           В итоге скачается архив .zip с 6 степенью сжатия, что неплохо уменьшает размер диалогов\n        ")]),n("p",[e._v("\n          Аутентификация может выполняться либо через токен (рекомендуемый метод), либо через логин\\пароль, по которому токен получается через сайт apidog.ru. \n          ")]),n("p",[e._v("Данный сайт работает только на клиенте, не имеет серверной\n          части и доступ к вашим данным имеете только вы и ВК (и apidog.ru, в случае входа через логин\\пароль). Никаких других запросов данное\n          приложение не отправляет, в этом можно убедиться отследив запросы (например, через панель разработчика chrome).\n        ")]),n("p",[e._v("\n          Данный сайт предназначен для использования\n          "),n("b",[e._v("исключительно")]),e._v(" со своим аккаунтом, и его целью является архивация\n          "),n("b",[e._v("собственной")]),e._v(" переписки.\n        ")]),n("p",[e._v("\n          Автор не несет ответственности за последствия вызванные использованием сайта не по назначению. Да и по назначению тоже, автор\n          "),n("b",[e._v("вообще")]),e._v(" не несет ответственности.\n          Любые манипуляции вы проводите на свой страх и риск.\n        ")])]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",flat:""},on:{click:function(t){e.moreInformationModel=!1}}},[e._v("Закрыть")])],1)],1)],1),n("v-card",[n("v-subheader",[e._v("Информация")]),n("v-card-text",{staticStyle:{"padding-top":"0px"}},[n("div",{staticClass:"text-xs-left"},[n("p",[e._v("\n          Это загрузчик сообщений ВК. Введите валидный токен или войдите используя пароль.\n          Затем выберите чаты, тип файлов и нажмите скачать.\n        ")]),n("p",[n("a",{on:{click:function(t){e.moreInformationModel=!0}}},[e._v("Больше информации")])])]),n("a",{attrs:{href:"https://github.com/zpix1/vk-pm-downloader"}},[e._v("Github")]),n("br"),e._v("\n      Сделал\n      "),n("a",{attrs:{href:"https://zpix1.github.io",target:"_blank"}},[e._v("@zpix")]),e._v(" в 2019\n    ")])],1)],1)},re=[],ie={name:"About",data:function(){return{moreInformationModel:!1}}},se=ie,ce=Object(te["a"])(se,ae,re,!1,null,null,null),le=ce.exports,ue={name:"Main",data:function(){return{scriptprice:B.script,tokenDialog:!1,logpassDialog:!1,token:null,myself:null,currentDialogProgress:0,currentDialogLabel:"",currentDialogPart:0,downloading:!1,inittingStage:0,error:!1,fileType:"HTML",chats:[],login:"",password:"",attachmentsDownloadMenu:!1,tokenHref:""}},created:function(){0},methods:{passwordLogin:function(){var e=this;this.logpassDialog=!1,this.inittingStage=1,u.a.post("https://apidog.ru/api/v2/apidog.authorize",{login:this.login,password:this.password,application:1}).then((function(t){return t=t.data,73===t.response.errorId?(e.error="ВК просит ввести капчу, а я эту функцию не сделал. Ждите.",void e.tokenUpdated()):t.response.userAccessToken?(e.token=t.response.userAccessToken,e.tokenUpdated(),void e.init()):(e.error="Неверная пара логин/пароль.",void e.tokenUpdated())}))},tokenUpdated:function(){this.inittingStage=0,this.chats=[],this.myself=null,this.currentDialogLabel="",k.token=this.token},init:function(){var e=this;this.error=!1,this.inittingStage=1,k.loadVK("users.get",{fields:"photo_50, photo_100, photo_200"},(function(t){if(!t)return e.error="Токен не валиден или недостаточно прав.",void e.tokenUpdated();e.myself=t[0],k.uid=t[0].id,k.myself=t[0]}),(function(t){5===t.error_code?e.error="Токен не валиден или недостаточно прав.":e.error="Ошибка сети (".concat(t.error_msg,")"),e.tokenUpdated()}));for(var t=[],n=0;n<25;n++)t.push("API.messages.getConversations({offset: ".concat(40*n,", count:40, extended: 1, v:5.81})"));k.loadVK("execute",{code:"return["+t.join(",")+"];"},(function(t){if(!t)return e.error="Токен не валиден или недостаточно прав.",void e.tokenUpdated();for(var n=[],o=0;o<t.length;o++)for(var a=t[o],r=0;r<a.items.length;r++){var i=a.items[r].conversation.peer.id,s=a.items[r].conversation;if("user"===s.peer.type){for(var c=0;c<a.profiles.length;c++)if(a.profiles[c].id===i){n.push({type:"user",peer_id:i,last_message:a.items[r].last_message,peerInfo:a.profiles[c],selected:!0}),a.items[r].peerInfo=a.profiles[c];break}}else if("group"===s.peer.type){for(var l=0;l<a.groups.length;l++)if(-a.groups[l].id===s.peer.id){var u={id:-a.groups[l].id,last_name:"",first_name:a.groups[l].name,photo_100:a.groups[l].photo_100,photo_50:a.groups[l].photo_50};n.push({type:"group",peer_id:i,last_message:a.items[r].last_message,peerInfo:u,selected:!0}),a.items[r].peerInfo=u;break}}else if("chat"===s.peer.type){var d={id:s.peer.id,last_name:"",first_name:s.chat_settings.title,photo_100:s.chat_settings.photo?s.chat_settings.photo.photo_100:"https://vk.com/images/camera_100.png?ava=1",photo_50:s.chat_settings.photo?s.chat_settings.photo.photo_50:"https://vk.com/images/camera_50.png?ava=1"};n.push({type:"chat",peer_id:s.peer.id,last_message:a.items[r].last_message,peerInfo:d,selected:!0})}}e.chats=n,e.inittingStage=3}),(function(t){5===t.error_code?e.error="Токен не валиден или недостаточно прав.":e.error="Ошибка сети (".concat(t.error_msg,")"),e.tokenUpdated()}))},reportProgress:function(e,t,n){this.currentDialogProgress=Math.ceil(t/n*100),this.currentDialogLabel=0==n?"".concat(e):"".concat(e," ").concat(t,"/").concat(n)},reportDialogProgress:function(e,t,n){this.currentDialogPart=Math.ceil(t/n*100)},downloadSelected:function(){var e=this;this.downloading=!0;var t=new p.a,n=this.chats.filter((function(e){return e.selected})),o=n.length,a=0,r=function(r){var s;s="JSON"===e.fileType?new Blob([r.data],{type:"application/json"}):new Blob([r.data],{type:"application/html"}),t.file(r.filename,s),setTimeout((function(){if(a++,a<o){var r=n[a].peer_id;e.reportProgress("Загрузка ".concat(n[a].peerInfo.first_name," ").concat(n[a].peerInfo.last_name),a+1,o);try{D.dialog(r,i,e.reportDialogProgress,"".concat(n[a].peerInfo.first_name," ").concat(n[a].peerInfo.last_name))}catch(s){e.reportProgress("ОШИБКА, ПРОПУСК ".concat(n[a].peerInfo.first_name," ").concat(n[a].peerInfo.last_name),a+1,o),console.error("ОШИБКА, ПРОПУСК ".concat(n[a].peerInfo.first_name," ").concat(n[a].peerInfo.last_name),s)}}else e.reportProgress("Создание zip архива",0,0),t.generateAsync({type:"blob",compression:"DEFLATE",comment:"Generated with VK PM Downloader v".concat("1.7.1"),compressionOptions:{level:6}}).then((function(t){Object(c["saveAs"])(t,"result_".concat(E(Object(f["slugify"])(e.myself.last_name)),"_").concat(E(Object(f["slugify"])(e.myself.first_name)),"_(id").concat(e.myself.id,")_").concat(e.fileType,"_").concat(new Date(Date.now()).toLocaleString().replace(/, /g,"_"),".zip")),e.reportProgress("Готово",0,0),e.downloading=!1}))}),x.mainLoop)},i=function(t){"HTML"===e.fileType?(e.reportProgress("Конвертация в HTML ".concat(n[a].peerInfo.first_name," ").concat(n[a].peerInfo.last_name),a+1,o),$.json2html(t,k.uid,r)):r(t)};this.reportProgress("Загрузка ".concat(n[a].peerInfo.first_name," ").concat(n[a].peerInfo.last_name),a+1,o),D.dialog(n[a].peer_id,i,this.reportDialogProgress,"".concat(n[a].peerInfo.first_name," ").concat(n[a].peerInfo.last_name))}},computed:{countSelected:function(){for(var e=0,t=0;t<this.chats.length;t++)this.chats[t].selected&&e++;return e},tokenHrefToken:function(){try{var e=this.tokenHref.replace("https://oauth.vk.com/blank.html#","").replace("oauth.vk.com/blank.html#",""),t=new URLSearchParams(e);return t.get("access_token")||""}catch(n){return""}}},components:{ChatList:oe,About:le}},de=ue,pe=(n("c266"),Object(te["a"])(de,i,s,!1,null,null,null)),fe=pe.exports,he={name:"app",components:{Main:fe},computed:{v:function(){return"1.7.1"}}},me=he,ge=(n("034f"),Object(te["a"])(me,a,r,!1,null,null,null)),ve=ge.exports,be=n("ce5b"),_e=n.n(be);n("bf40"),n("d1e7");o["default"].use(_e.a,{iconfont:"md"}),o["default"].config.productionTip=!1,new o["default"]({render:function(e){return e(ve)}}).$mount("#app")},"64a9":function(e,t,n){},c266:function(e,t,n){"use strict";var o=n("287b"),a=n.n(o);a.a},fc86:function(e,t,n){"use strict";var o=n("2bb6"),a=n.n(o);a.a}});
//# sourceMappingURL=app.e88022e2.js.map